# tcc-compiler

- 本仓库托管了一个全面的学习项目，专注于编译器开发，其最终目标是创建一个类似于C++语言的编译器。
- 该项目包括词法分析器和语法分析器的手工开发，有意避开了如flex和bison这样的自动化工具，以支持亲手实践理解编译器构建的复杂性。
- 该计划计划与LLVM接口，以生成可执行程序，标志着项目进展中的一个重要里程碑。最初，该项目旨在实现C语言的一个子集，为逐步扩展语法规则提供坚实的基础。
- 这个雄心勃勃的教育企划不仅旨在加深对编译器机制的理解，还旨在培养编译器设计和实现的全面技能。

## 第一阶段目标

### 关键特性

此阶段的主要特性包括：

- **关键字**：编译器将识别一组必要的关键字，包括`int`、`void`、`main`、`return`和`print`。这些关键字构成了语言结构的骨架，允许定义变量类型、函数和控制流机制。
- **标识符**：此阶段不包括对标识符的支持。未来的更新将引入在语言中定义和使用变量名及其他标识符的能力。
- **数值常量**：仅由数字组成的序列将被识别为数值常量，提供了在表达式中包含文字数值的能力。
- **运算符**：编译器将支持基本的算术操作，这些操作由运算符`+`（加法）、`-`（减法）、`*`（乘法）、`/`（除法）表示，并通过圆括号`(`、`)`来分组表达式，以覆盖操作的默认优先级。
- **大括号和分号**：编译器将遵循C/C++的惯例，使用花括号`{`、`}`来包裹函数体，用分号`;`来标记语句的结束。这一特性确保了代码块的结构和语句终止的明确定义。
- **空白字符**：空格、制表符和换行符将被识别为空白，用于分隔源代码中的标记。这些字符虽然对代码的可读性和组织至关重要，但它们本身并不代表标记。
- **注释**：此阶段不包括对注释的支持，而是专注于语言的核心构造。

### 编译策略

完成词法、语法和语义分析后，将生成一个抽象语法树（AST）。然后，这个AST将通过两条不同的路径转换，以生成可执行程序：

1. **转换为C/C++**：AST将被转换为等价的C或C++代码，随后使用GCC编译以产生可执行程序。这种方法提供了一种直接的方式来验证AST的正确性和整体编译器逻辑。
2. **转换为中间表示（IR）**：AST将被转换为中间表示（IR），利用LLVM编译器基础设施生成可执行程序。这条路径标志着一个重要的里程碑，展示了项目与复杂编译器技术接口的能力，并为更高级的特性和优化奠定了基础。

### 第一阶段的测试用例

- 为了验证第一阶段开发的编译器的功能和准确性，将使用以下测试用例。这些示例旨在展示编译器处理基本算术表达式和函数定义的能力。

#### 测试用例1：

```cpp
int main() {
    print(1+2);
}
```

- 此测试用例检查编译器解析和执行`print`函数调用中的简单算术表达式的能力。它还测试了处理作为TinyC程序入口点的`int main()`函数结构的能力。

#### 测试用例2：

```cpp
int main() {
    print((12+5)*3/2);
}
```

- 第二个测试用例稍微复杂些，涉及多个算术运算，使用括号指定操作顺序。此测试旨在验证编译器正确解释涉及加法、减法、乘法和除法的算术表达式的能力，以及其处理运算符优先级和结合性的能力。